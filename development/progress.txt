## Phase -1: Svelte 5 Upgrade - COMPLETED

### What was done:
- Updated Svelte from 4.2.5 to 5.47.0
- Updated SvelteKit from 1.27.6 to 2.50.0
- Updated Vite from 4.5.0 to 6.4.1
- Added @sveltejs/vite-plugin-svelte 5.1.1
- Updated adapters (auto and static) to v3
- Updated svelte-check to v4
- Fixed vitePreprocess import path in svelte.config.js (moved to @sveltejs/vite-plugin-svelte)
- Added Umami analytics global type declaration in app.d.ts
- Fixed pre-existing type errors by adding null checks for umami global

### Verification:
- pnpm check passes with 0 errors (only CSS warnings expected with Tailwind)
- pnpm build succeeds
- Dev server starts correctly

### Notes:
- Existing components use Svelte 4 syntax (backward compatible)
- New components will use Svelte 5 runes ($state, $effect, $derived)

Commit: 87e235f

---

## Phase 0: YouTube IFrame Player API - COMPLETED

### What was done:
- Created `src/lib/stores/playerStore.ts` - Player state management
  - Svelte stores for currentTime, duration, playbackRate, playerState
  - Combined playerStore for convenience
  - subscribeToTime() for skip features to hook into time updates
  - ytStateToString() helper to convert YT state numbers to readable strings
  - resetPlayerStore() for video navigation

- Created `src/lib/components/YouTubePlayer.svelte` - YouTube IFrame Player API component
  - Loads YouTube IFrame API script dynamically
  - Initializes player with new YT.Player()
  - Handles onReady and onStateChange events
  - 100ms time polling when PLAYING, stops on pause/end/buffer
  - Exposed controls: play, pause, seekTo, getCurrentTime, setPlaybackRate, getPlaybackRate, getDuration
  - All player method calls guarded (if player && typeof player.method === 'function')
  - Maintains 16:9 responsive aspect ratio
  - Handles videoId changes via $effect
  - Proper cleanup on component destroy

- Added YouTube IFrame API TypeScript declarations in `src/app.d.ts`
  - YT namespace with Player class, PlayerState, event types
  - onYouTubeIframeAPIReady global callback type

- Integrated YouTubePlayer into `src/routes/[url]/+page.svelte`
  - Replaced raw iframe with YouTubePlayer component
  - Removed redundant wrapper styles (now in component)

### Verification:
- pnpm check passes with 0 errors
- pnpm build succeeds
- Player loads via IFrame API
- Programmatic control available (play, pause, seekTo, etc.)
- Player state accessible via Svelte stores
- 100ms time polling when playing
- No visual regression from previous embed

### Notes:
- Uses Svelte 5 runes ($state, $effect) alongside traditional stores
- Traditional stores used for cross-component reactivity (playerStore)
- Component-local state uses $state rune
- Pre-existing setTimeout memory leak in +page.svelte noted but not fixed (out of scope)

Commit: 74be604

---

## Phase 1: Minimal UI Shell - COMPLETED

### What was done:
- Created `src/lib/components/VideoTools.svelte` - Dropdown container
  - Collapsible "▸ video tools" / "▾ video tools" toggle
  - Uses Svelte 5 runes ($state) and snippets ($props with Snippet type)
  - Accepts `dropdown` and `active` snippets for features to populate
  - Empty state shows "No tools available yet"
  - Emerald link styling matching existing aesthetic

- Created `src/lib/utils/videoToolsParams.ts` - URL param helpers
  - getActiveTools(url): string[] - parse ?tools= param
  - updateToolsParam(url, toolName, active) - add/remove tool from URL
  - isToolActive(url, toolName): boolean - check if tool is active
  - Pure functions that accept URL (not reactive store access)

- Integrated VideoTools into `src/routes/[url]/+page.svelte`
  - Replaced "more tools" link with VideoTools component
  - Positioned above "about" link

### Verification:
- pnpm check passes with 0 errors
- pnpm build succeeds
- Dropdown expands/collapses on click
- URL param helpers work correctly

### Notes:
- Features will add their own toggles via the dropdown snippet
- Features will add their own active UI via the active snippet
- URL param format: ?tools=silence (comma-separated for multiple)
- SponsorBlock enabled by default (no URL param needed per PRD)

Commit: 5d933fd
